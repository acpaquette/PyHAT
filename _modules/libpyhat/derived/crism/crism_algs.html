<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>libpyhat.derived.crism.crism_algs &mdash; PyHAT</title>
    
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../../../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" >
    <link rel="search" title="Search" href="../../../../search.html" >
    <link rel="top" title="PyHAT" href="../../../../index.html" >
    <link rel="up" title="Module code" href="../../../index.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../../../../index.html">PyHAT</a></li>
	
          <li class="active"><a href="../../../index.html" accesskey="U">Module code</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../../../../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/favicon.png" alt="Logo">
            </a></p>

        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <h1>Source code for libpyhat.derived.crism.crism_algs</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">crism_funcs</span> <span class="k">as</span> <span class="n">cf</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="k">import</span> <span class="n">generic_func</span>


<div class="viewcode-block" id="r770"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r770">[docs]</a><span class="k">def</span> <span class="nf">r770</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R770</span>
<span class="sd">    Parameter: 0.77micron reflectance</span>
<span class="sd">    Formulation: R770</span>
<span class="sd">    Rationale: Higher value more dusty or icy</span>
<span class="sd">    Caveats: Sensitive to slope effects, clouds</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">770</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">770</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust1_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="rbr"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.rbr">[docs]</a><span class="k">def</span> <span class="nf">rbr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: RBR</span>
<span class="sd">    Parameter: Red/Blue Ratio</span>
<span class="sd">    Formulation: R770 / R440</span>
<span class="sd">    Rationale: Higher value indicates more npFeOx</span>
<span class="sd">    Caveats: Sensitive to dust in atmosphere</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">440</span><span class="p">,</span> <span class="mi">770</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">440</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
               <span class="mi">770</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd530"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd530">[docs]</a><span class="k">def</span> <span class="nf">bd530</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD530</span>
<span class="sd">    PARAMETER: 0.53 micron band depth</span>
<span class="sd">    FORMULATION: 1 - (R530/(a*R709+b*R440))</span>
<span class="sd">    RATIONALE: Crystalline ferric minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">440</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span> <span class="mi">716</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">440</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span> <span class="mi">614</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">440</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">530</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">614</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func1</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="sh600"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.sh600">[docs]</a><span class="k">def</span> <span class="nf">sh600</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: SH600</span>
<span class="sd">    PARAMETER: 0.60 micron shoulder height</span>
<span class="sd">    FORMULATION: 1 - (a * R530 + b * R709) / R600</span>
<span class="sd">    FORMULATION (with kernels): 1 - (a * R533 + b * R716) / R600</span>
<span class="sd">    RATIONALE: select ferric minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">530</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">709</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">533</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">716</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">533</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">600</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">716</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">sh_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="sh770"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.sh770">[docs]</a><span class="k">def</span> <span class="nf">sh770</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: SH770</span>
<span class="sd">    PARAMETER: 0.77 micron shoulder height</span>
<span class="sd">    FORMULATION (with kernels): 1 - (a * R716 + b * R860) / R775</span>
<span class="sd">    RATIONALE: select ferric minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">716</span><span class="p">,</span> <span class="mi">775</span><span class="p">,</span> <span class="mi">860</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">716</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
               <span class="mi">775</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">860</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">sh_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd640"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd640">[docs]</a><span class="k">def</span> <span class="nf">bd640</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD640</span>
<span class="sd">    PARAMETER: 0.64 micron band depth</span>
<span class="sd">    FORMULATION: 1 - (R648 / (a * R600 + b * R709))</span>
<span class="sd">    FORMULATION (with kernels): 1 - (R624 / (a * R600 + b * R760))</span>
<span class="sd">    RATIONALE: select ferric minerals, especially maghemite</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">648</span><span class="p">,</span> <span class="mi">709</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">624</span><span class="p">,</span> <span class="mi">760</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">600</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">624</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">760</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd860"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd860">[docs]</a><span class="k">def</span> <span class="nf">bd860</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD860</span>
<span class="sd">    PARAMETER: 0.86 micron band depth</span>
<span class="sd">    FORMULATION: 1 - (R860 / (a * R800 + b * R984))</span>
<span class="sd">    FORMULATION (with kernels): 1 - (R860 / (a * R755 + b * R977))</span>
<span class="sd">    RATIONALE: select ferric minerals (&#39;hematite band&#39;)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">860</span><span class="p">,</span> <span class="mi">984</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">755</span><span class="p">,</span> <span class="mi">860</span><span class="p">,</span> <span class="mi">977</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">755</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">860</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">977</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd920"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd920">[docs]</a><span class="k">def</span> <span class="nf">bd920</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD920</span>
<span class="sd">    PARAMETER: 0.92 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R920 / (a * R800 + b * R984) )</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R920 / (a * R807 + b * R984) )</span>
<span class="sd">    RATIONALE: select ferric minerals (&#39;Pseudo BDI1000 VIS&#39;)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">800</span><span class="p">,</span><span class="mi">920</span><span class="p">,</span><span class="mi">984</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">807</span><span class="p">,</span> <span class="mi">920</span><span class="p">,</span> <span class="mi">984</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">807</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">920</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">984</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="rpeak1"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.rpeak1">[docs]</a><span class="k">def</span> <span class="nf">rpeak1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BDI1000VIS</span>
<span class="sd">    PARAMETER: 1 micron integrated band depth; VIS wavelengths</span>
<span class="sd">    FORMULATION: divide R830, R860, R890, R915 by RPEAK1 then\</span>
<span class="sd">      integrate over (1 -  normalized radiances)</span>
<span class="sd">    RATIONALE: crystalline Fe+2 or Fe+3 minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wvs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">wavelengths</span>
    <span class="n">vnir_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">wvs</span> <span class="o">&gt;</span> <span class="mi">400</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">wvs</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">vnir_wvs</span> <span class="o">=</span> <span class="n">wvs</span><span class="p">[</span><span class="n">vnir_mask</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wvs</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rpeak1_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="c1"># TODO: bdi1000VIS</span>
<div class="viewcode-block" id="bdi1000VIS"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bdi1000VIS">[docs]</a><span class="k">def</span> <span class="nf">bdi1000VIS</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BDI1000VIS</span>
<span class="sd">    PARAMETER: 1 micron integrated band depth; VIS wavelengths</span>
<span class="sd">    FORMULATION: divide R830, R860, R890, R915 by RPEAK1 then\</span>
<span class="sd">      integrate over (1 -  normalized radiances)</span>
<span class="sd">    RATIONALE: crystalline Fe+2 or Fe+3 minerals</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<span class="c1"># TODO: bdi1000IR</span>
<div class="viewcode-block" id="bdi1000IR"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bdi1000IR">[docs]</a><span class="k">def</span> <span class="nf">bdi1000IR</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BDI1000IR</span>
<span class="sd">    PARAMETER: 1 micron integrated band depth; IR wavelengths</span>
<span class="sd">    FORMULATION: divide R1030, R1050, R1080, R1150\</span>
<span class="sd">     by linear fit from peak R  between 1.3 - 1.87 microns to R2530\</span>
<span class="sd">     extrapolated backwards, then integrate over (1 -  normalized\</span>
<span class="sd">     radiances)</span>
<span class="sd">    RATIONALE: crystalline Fe+2 minerals; corrected for overlying\</span>
<span class="sd">    aerosol induced slope</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<div class="viewcode-block" id="r1330"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r1330">[docs]</a><span class="k">def</span> <span class="nf">r1330</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: R1330</span>
<span class="sd">    PARAMETER: IR albedo</span>
<span class="sd">    FORMULATION: R1330</span>
<span class="sd">    RATIONALE: IR albedo (ices &gt; dust &gt; unaltered mafics)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1330</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1330</span><span class="p">:</span> <span class="mi">11</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd1300"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1300">[docs]</a><span class="k">def</span> <span class="nf">bd1300</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    NAME: BD1300</span>
<span class="sd">    PARAMETER: 1.3 μm absorption associated with Fe2+ substitution in\</span>
<span class="sd">        plagioclase</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R1320 / (a * R1080 + b * R1750) )</span>
<span class="sd">    RATIONALE: Plagioclase with Fe2+ substitution</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1320</span><span class="p">,</span> <span class="mi">1750</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1370</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">1432</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
               <span class="mi">1470</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="olivine_index2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.olivine_index2">[docs]</a><span class="k">def</span> <span class="nf">olivine_index2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: OLINDEX (prior to TRDR version 3)</span>
<span class="sd">    PARAMETER: olivine index</span>
<span class="sd">    FORMULATION: (R1695 / (0.1*R1080 + 0.1*R1210 + 0.4*R1330 +\</span>
<span class="sd">      0.4*R1470)) - 1</span>
<span class="sd">    RATIONALE: olivine will be strongly +; based on fayalite</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1210</span><span class="p">,</span> <span class="mi">1330</span><span class="p">,</span> <span class="mi">1470</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">2400</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">olivine_index2_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="c1">#@@TODO olivine_index2 (labeled olivine_index3 in JPL doc?</span>
<div class="viewcode-block" id="olivine_index3"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.olivine_index3">[docs]</a><span class="k">def</span> <span class="nf">olivine_index3</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: OLINDEX2 (beginning with TRDR version 3)</span>
<span class="sd">    PARAMETER: olivine index with less sensitivity to illumination</span>
<span class="sd">    FORMULATION: RB1080 * 0.03 + RB1152 * 0.03 + RB1210 * 0.03 +\</span>
<span class="sd">        RB1250 * 0.03 + RB1263 * 0.07 + RB1276 * 0.07 +\</span>
<span class="sd">        RB1330 * 0.12 + RB1368 * 0.12 + RB1395 * 0.14 +\</span>
<span class="sd">        RB1427 * 0.18 + RB1470 * 0.18</span>
<span class="sd">    RATIONALE: olivine will be strongly positive</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1152</span><span class="p">,</span> <span class="mi">1210</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1263</span><span class="p">,</span> <span class="mi">1276</span><span class="p">,</span> <span class="mi">1330</span><span class="p">,</span> <span class="mi">1368</span><span class="p">,</span> <span class="mi">1395</span><span class="p">,</span> <span class="mi">1427</span><span class="p">,</span> <span class="mi">1470</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">2400</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1080</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1152</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1210</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1250</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1263</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1276</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1330</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1368</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">1395</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1427</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1470</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1750</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2400</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">olivine_index3_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="lcp_index"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.lcp_index">[docs]</a><span class="k">def</span> <span class="nf">lcp_index</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: LCPINDEX</span>
<span class="sd">    PARAMETER: LCP index</span>
<span class="sd">    FORMULATION: ((R1330 - R1050)/(R1330 + R1050)) *\</span>
<span class="sd">                   ((R1330 - R1815)/(R1330 + R1815))</span>
<span class="sd">    RATIONALE: Pyroxene is strongly +; favors LCP</span>

<span class="sd">    Algorithm differs from published - coded as per CAT &lt;--- What?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1330</span><span class="p">,</span> <span class="mi">1815</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">index1_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="lcp_index2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.lcp_index2">[docs]</a><span class="k">def</span> <span class="nf">lcp_index2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: LCPINDEX2</span>
<span class="sd">    PARAMETER: Detect broad absorption centered at 1.81 μm</span>
<span class="sd">    FORMULATION (with kernels):\</span>
<span class="sd">        RB1690 * 0.20 + RB1750 * 0.20 + RB1810 * 0.30 + RB1870 * 0.30\</span>
<span class="sd">        Anchored at R1560 and R2450</span>
<span class="sd">    RATIONALE: Pyroxene is strongly +; favors LCP</span>

<span class="sd">    Algorithm differs from published - coded as per CAT &lt;--- What?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1690</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">1810</span><span class="p">,</span> <span class="mi">1870</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1560</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">1690</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">1750</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">1810</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">1870</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2450</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">lcp_index2_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="hcp_index"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.hcp_index">[docs]</a><span class="k">def</span> <span class="nf">hcp_index</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: HCPXINDEX</span>
<span class="sd">    PARAMETER: pyroxene index</span>
<span class="sd">    FORMULATION: 100 * ((R1470 - R1050) / (R1470 + R1050)) *\</span>
<span class="sd">                         ((R1470 - R2067) / (R1470 + R2067))</span>
<span class="sd">    RATIONALE: pyroxene is strongly +; favors high-Ca pyroxene</span>

<span class="sd">    Algorithm differs from published - coded as per CAT &lt;--- What?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1050</span><span class="p">,</span> <span class="mi">1470</span><span class="p">,</span> <span class="mi">2067</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">index1_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="hcp_index2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.hcp_index2">[docs]</a><span class="k">def</span> <span class="nf">hcp_index2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: HCPXINDEX</span>
<span class="sd">    PARAMETER: pyroxene index</span>
<span class="sd">    FORMULATION: 100 * ((R1470 - R1050) / (R1470 + R1050)) *\</span>
<span class="sd">                         ((R1470 - R2067) / (R1470 + R2067))</span>
<span class="sd">    RATIONALE: pyroxene is strongly +; favors high-Ca pyroxene</span>

<span class="sd">    Algorithm differs from published - coded as per CAT &lt;--- What?</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2140</span><span class="p">,</span> <span class="mi">2230</span><span class="p">,</span> <span class="mi">2250</span><span class="p">,</span> <span class="mi">2430</span><span class="p">,</span> <span class="mi">2460</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1810</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">2140</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2230</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2250</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2430</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2460</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
               <span class="mi">2530</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">hcp_index2_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="sd">&#39;&#39;&#39;#@@TODO var</span>
<span class="sd">def var(data, **kwargs):</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="sd">    NAME: VAR</span>
<span class="sd">    PARAMETER: spectral variance</span>
<span class="sd">    FORMULATION: find variance from a line fit from 1 - 2.3 micron</span>
<span class="sd">      by summing in quadrature over the intervening wavelengths</span>
<span class="sd">    RATIONALE: Ol &amp; Px will have high values; Type 2 areas will have</span>
<span class="sd">      low values</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="sd">    raise NotImplementedError&#39;&#39;&#39;</span>


<div class="viewcode-block" id="islope1"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.islope1">[docs]</a><span class="k">def</span> <span class="nf">islope1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: ISLOPE1</span>
<span class="sd">    PARAMETER: -1 * spectral slope1</span>
<span class="sd">    FORMULATION: (R1815-R2530) / (2530-1815)</span>
<span class="sd">    RATIONALE: ferric coating on dark rock</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1815</span><span class="p">,</span> <span class="mi">2530</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1815</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">2530</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">islope1_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd1400"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1400">[docs]</a><span class="k">def</span> <span class="nf">bd1400</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1400</span>
<span class="sd">    PARAMETER: 1.4 micron H2O and OH band depth</span>
<span class="sd">    FORMULATION: 1 - ( R1395 / (a * R1330 + b * R1467) )</span>
<span class="sd">    RATIONALE: Hydrated or hydroxylated minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">1395</span><span class="p">,</span> <span class="mi">1467</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1370</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">1432</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
               <span class="mi">1470</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd1435"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1435">[docs]</a><span class="k">def</span> <span class="nf">bd1435</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1435</span>
<span class="sd">    PARAMETER: 1.435 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R1435 / (a * R1370 + b * R1470) )</span>
<span class="sd">    RATIONALE: CO2 ice, some hydrated minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1370</span><span class="p">,</span> <span class="mi">1435</span><span class="p">,</span> <span class="mi">1470</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1370</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
               <span class="mi">1432</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="mi">1470</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd1500"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1500">[docs]</a><span class="k">def</span> <span class="nf">bd1500</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1500</span>
<span class="sd">    PARAMETER: 1.5 micron H2O ice band depth</span>
<span class="sd">    FORMULATION: 1.0 - ((R1505 + R1558) / (R1808 + R1367))</span>
<span class="sd">    FORMULATION (with kernels): 1.0 - (R1525 / (b * R1808 + a * R1367))</span>
<span class="sd">    RATIONALE: H2O surface ice</span>
<span class="sd">    Algorithm differs from published - coded as per CAT (reduced instrument noise)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1367</span><span class="p">,</span> <span class="mi">1525</span><span class="p">,</span> <span class="mi">1808</span><span class="p">]</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1367</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                          <span class="mi">1525</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
                          <span class="mi">1808</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1367</span><span class="p">,</span> <span class="mi">1505</span><span class="p">,</span> <span class="mi">1558</span><span class="p">,</span> <span class="mi">1808</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd1500_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="icer1"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.icer1">[docs]</a><span class="k">def</span> <span class="nf">icer1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: ICER1</span>
<span class="sd">    PARAMETER: 1.5 micron and 1.43 micron band ratio</span>
<span class="sd">    FORMULATION (with kernels): R1510 / R1430</span>
<span class="sd">    RATIONALE: CO2, H20 ice mixtures</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1430</span><span class="p">,</span> <span class="mi">1510</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1430</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="mi">1510</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="icer1_2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.icer1_2">[docs]</a><span class="k">def</span> <span class="nf">icer1_2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: ICER1_2</span>
<span class="sd">    PARAMETER: 1.5 micron and 1.43 micron band ratio</span>
<span class="sd">    FORMULATION: 1 - ((1 - bd1435) / (1 - bd1500))</span>
<span class="sd">    RATIONALE: CO2, H20 ice mixtures</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bd1435_val</span> <span class="o">=</span> <span class="n">bd1435</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">bd1500_val</span> <span class="o">=</span> <span class="n">bd1500</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bd1435_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bd1500_val</span><span class="p">))</span></div>


<div class="viewcode-block" id="bd1750"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1750">[docs]</a><span class="k">def</span> <span class="nf">bd1750</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1750</span>
<span class="sd">    PARAMETER: 1.7 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R1750 / (a * R1550 + b * R1815) )</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R1750 / (a * R1690 + b * R1815) )</span>
<span class="sd">    RATIONALE: gypsum</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1550</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">1815</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1690</span><span class="p">,</span> <span class="mi">1750</span><span class="p">,</span> <span class="mi">1815</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">1690</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">1750</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">1815</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="bd1900"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1900">[docs]</a><span class="k">def</span> <span class="nf">bd1900</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1900</span>
<span class="sd">    PARAMETER: 1.9 micron band depth</span>
<span class="sd">    FORMULATION: 1.0 - ((R1985 + R1930)/(R2067 + R1875))</span>
<span class="sd">    RATIONALE: H2O, chemically bound or adsorbed</span>
<span class="sd">    Algorithm differs from published - coded as per CAT (reduced instrument noise)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1875</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">1985</span><span class="p">,</span> <span class="mi">2067</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd1900_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd1900_2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1900_2">[docs]</a><span class="k">def</span> <span class="nf">bd1900_2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1900_2</span>
<span class="sd">    PARAMETER: 1.9 micron band depth</span>
<span class="sd">    FORMULATION (with kernels):\</span>
<span class="sd">        .5 * (1 - (R1930 / (a * R1850 + b * R2067))) +\</span>
<span class="sd">        .5 * (1 - (R1985 / (a * R1850 + b * R2067)))</span>
<span class="sd">    RATIONALE: H2O, chemically bound or adsorbed</span>

<span class="sd">    Algorithm differs from published - coded as per CAT (reduced instrument noise)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2067</span><span class="p">]</span>
    <span class="n">kernel_set1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1850</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">1930</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">2046</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">1985</span><span class="p">,</span> <span class="mi">2067</span><span class="p">]</span>
    <span class="n">kernel_set2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1850</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">1985</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">2046</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">bd_1</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd_2</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bd_1</span><span class="p">)</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bd_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd1900r"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1900r">[docs]</a><span class="k">def</span> <span class="nf">bd1900r</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1900r</span>
<span class="sd">    PARAMETER: 1.9 micron band depth</span>
<span class="sd">    FORMULATION: 1.0 - ((R1908 + R1914 + R1921 + R1928 + R1934 + R1941) / \</span>
<span class="sd">                          (R1862 + R1869 + R1875 + R2112 + R2120 + R2126))</span>
<span class="sd">    RATIONALE: H2O, chemically bound or adsorbed</span>
<span class="sd">    Algorithm differs from published - coded as per CAT (reduced instrument noise)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1908</span><span class="p">,</span> <span class="mi">1914</span><span class="p">,</span> <span class="mi">1921</span><span class="p">,</span> <span class="mi">1928</span><span class="p">,</span> <span class="mi">1934</span><span class="p">,</span> <span class="mi">1941</span><span class="p">,</span>
          <span class="mi">1862</span><span class="p">,</span> <span class="mi">1869</span><span class="p">,</span> <span class="mi">1875</span><span class="p">,</span> <span class="mi">2112</span><span class="p">,</span> <span class="mi">2120</span><span class="p">,</span> <span class="mi">2126</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd1900r_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd1900r2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd1900r2">[docs]</a><span class="k">def</span> <span class="nf">bd1900r2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD1900r2</span>
<span class="sd">    PARAMETER: 1.9 micron band depth</span>
<span class="sd">    FORMULATION:\</span>
<span class="sd">1 - ((R1908 / RC1908 + R1914 / RC1914 + R1921 / RC1921 + R1928 / RC1928 + R1934 / RC1934 + R1941 / RC1941) /\</span>
<span class="sd">      (R1862 / RC1862 + R1869 / RC1869 + R1875 / RC1875 + R2112 / RC2112 + R2120 / RC2120 + R2126 / RC2126))</span>
<span class="sd">    RATIONALE: H2O, chemically bound or adsorbed</span>

<span class="sd">    Algorithm differs from published - coded as per CAT (reduced instrument noise)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">1862</span><span class="p">,</span> <span class="mi">1869</span><span class="p">,</span> <span class="mi">1875</span><span class="p">,</span> <span class="mi">1908</span><span class="p">,</span> <span class="mi">1914</span><span class="p">,</span> <span class="mi">1921</span><span class="p">,</span> <span class="mi">1928</span><span class="p">,</span> <span class="mi">1934</span><span class="p">,</span> <span class="mi">1941</span><span class="p">,</span> <span class="mi">2060</span><span class="p">,</span> <span class="mi">2112</span><span class="p">,</span> <span class="mi">2120</span><span class="p">,</span> <span class="mi">2126</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd1900r2_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="c1"># TODO:  bdi2000</span>
<div class="viewcode-block" id="bdi2000"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bdi2000">[docs]</a><span class="k">def</span> <span class="nf">bdi2000</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BDI2000</span>
<span class="sd">    PARAMETER: 2 micron integrated band depth</span>
<span class="sd">    FORMULATION: divide R1660, R1815, R2140, R2210, R2250, R2290,\</span>
<span class="sd">      R2330, R2350, R2390, R2430, R2460 by linear fit from peak R\</span>
<span class="sd">      between 1.3 - 1.87 microns to R2530, then integrate over\</span>
<span class="sd">     (1 -  normalized radiances)</span>
<span class="sd">    RATIONALE: pyroxene abundance and particle size</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<div class="viewcode-block" id="bd2100"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2100">[docs]</a><span class="k">def</span> <span class="nf">bd2100</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2100</span>
<span class="sd">    PARAMETER: 2.1 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( ((R2120 + R2140) * 0.5) / (a * R1930 + b * R2250) )</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R2132 / (a * R1930 + b * R2250) )</span>
<span class="sd">    RATIONALE: monohydrated minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1930</span><span class="p">,</span> <span class="mi">2132</span><span class="p">,</span> <span class="mi">2250</span><span class="p">]</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1930</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                          <span class="mi">2132</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                          <span class="mi">2250</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1930</span><span class="p">,</span> <span class="mi">2120</span><span class="p">,</span> <span class="mi">2130</span><span class="p">,</span> <span class="mi">2250</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd2100_func</span><span class="p">,</span> <span class="n">pass_wvs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2165"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2165">[docs]</a><span class="k">def</span> <span class="nf">bd2165</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2165</span>
<span class="sd">    PARAMETER: 2.165 micron Al-OH band depth</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R2165 / (a * R2120 + b * R2230) )</span>
<span class="sd">    RATIONALE: Pyrophyllite Kaolinite group</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2165</span><span class="p">,</span> <span class="mi">2230</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2165</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2230</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2190"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2190">[docs]</a><span class="k">def</span> <span class="nf">bd2190</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2190</span>
<span class="sd">    PARAMETER: 2.190 micron Al-OH band depth</span>
<span class="sd">    FORMULATION (with kernels): 1 - ( R2185 / (a * R2120 + b * R2250) )</span>
<span class="sd">    RATIONALE: Beidellite Allophane Imogolite</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2185</span><span class="p">,</span> <span class="mi">2250</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2185</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2250</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="doub2200h"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.doub2200h">[docs]</a><span class="k">def</span> <span class="nf">doub2200h</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: DOUB2200H</span>
<span class="sd">    PARAMETER: 2.16 micron Si-OH band depth and 2.21 micron H-bound Si-OH band\</span>
<span class="sd">        depth (doublet)</span>
<span class="sd">    FORMULATION (with kernels): 1 - ((R2205 + R2258) / (R2172 + R2311))</span>
<span class="sd">    RATIONALE: Opal and other Al-OH minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2172</span><span class="p">,</span> <span class="mi">2205</span><span class="p">,</span> <span class="mi">2258</span><span class="p">,</span> <span class="mi">2311</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2172</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2205</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2258</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2311</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">doub2200h_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="min2200"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.min2200">[docs]</a><span class="k">def</span> <span class="nf">min2200</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: MIN2200</span>
<span class="sd">    PARAMETER: 2.16 μm Si-OH band depth and 2.21 μm H-bound Si-OH band\</span>
<span class="sd">        depth (doublet)</span>
<span class="sd">    FORMULATION (with kernels): minimum( 1 -  (R2165 / (a * R2120 + b * R2350)),\</span>
<span class="sd">        1 - (R2210 / (a * R2120 + b * R2350)))</span>
<span class="sd">    RATIONALE: Kaolinite group</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2165</span><span class="p">,</span> <span class="mi">2350</span><span class="p">]</span>
    <span class="n">kernel_set1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2165</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2350</span><span class="p">]</span>
    <span class="n">kernel_set2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2210</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">bd_1</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd_2</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bd_1</span><span class="p">,</span> <span class="n">bd_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2210"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2210">[docs]</a><span class="k">def</span> <span class="nf">bd2210</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2210</span>
<span class="sd">    PARAMETER: 2.21 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R2210 / (a*R2140+b*R2250) )</span>
<span class="sd">    RATIONALE: Al-OH minerals: monohydrated minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2250</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2165</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2250</span><span class="p">]</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">2165</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">2210</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">kernels</span><span class="p">[</span><span class="mi">2250</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="d2200"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.d2200">[docs]</a><span class="k">def</span> <span class="nf">d2200</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: D2200</span>
<span class="sd">    PARAMETER: 2.2 micron dropoff</span>
<span class="sd">    FORMULATION (with kernels): 1 - (((R2210 / RC2210) + (R2230 / RC2230)) / (2 * (R2165 / RC2165)))\</span>
<span class="sd">        Slope for RC#### anchored at R1815 and R2430.</span>
<span class="sd">    RATIONALE: Al-OH minerals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1815</span><span class="p">,</span> <span class="mi">2165</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2230</span><span class="p">,</span> <span class="mi">2430</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1815</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                      <span class="mi">2165</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2210</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                      <span class="mi">2230</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                      <span class="mi">2430</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">d2200_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2230"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2230">[docs]</a><span class="k">def</span> <span class="nf">bd2230</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2230</span>
<span class="sd">    PARAMETER: 2.23 μm band depth</span>
<span class="sd">    FORMULATION (with kernels): 1 - (R2235 / (a * R2210 + b * R2252))</span>
<span class="sd">    RATIONALE: Hydroxylated ferric sulfates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2210</span><span class="p">,</span> <span class="mi">2235</span><span class="p">,</span> <span class="mi">2252</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2210</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2235</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2252</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2250"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2250">[docs]</a><span class="k">def</span> <span class="nf">bd2250</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2250</span>
<span class="sd">    PARAMETER: 2.25 μm band depth</span>
<span class="sd">    FORMULATION (with kernels): 1 - (R2245 / (a * R2120 + b * R2340))</span>
<span class="sd">    RATIONALE: 2.25 μm broad Al-OH and Si-OH band depth</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2245</span><span class="p">,</span> <span class="mi">2340</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2245</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                      <span class="mi">2340</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="min2250"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.min2250">[docs]</a><span class="k">def</span> <span class="nf">min2250</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: MIN2250</span>
<span class="sd">    PARAMETER: 2.21 μm Si-OH band depth and 2.26 μm H-bound Si-OH\</span>
<span class="sd">        band depth</span>
<span class="sd">    FORMULATION (with kernels): minimum( 1 -  (R2210 / (a * R2165 + b * R2350)),\</span>
<span class="sd">        1 - (R2265 / (a * R2165 + b * R2350)))</span>
<span class="sd">    RATIONALE: Opal</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2165</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2350</span><span class="p">]</span>
    <span class="n">kernel_set1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2165</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2210</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2165</span><span class="p">,</span> <span class="mi">2265</span><span class="p">,</span> <span class="mi">2350</span><span class="p">]</span>
    <span class="n">kernel_set2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2165</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2265</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">bd_1</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd_2</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bd_1</span><span class="p">,</span> <span class="n">bd_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2265"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2265">[docs]</a><span class="k">def</span> <span class="nf">bd2265</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2265</span>
<span class="sd">    PARAMETER: 2.265 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R2265 / (a*R2210+b*R2340) )</span>
<span class="sd">    RATIONALE: Jarosite Gibbsite Acid-leached nontronite</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2210</span><span class="p">,</span> <span class="mi">2265</span><span class="p">,</span> <span class="mi">2340</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2210</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2265</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2340</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2290"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2290">[docs]</a><span class="k">def</span> <span class="nf">bd2290</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2290</span>
<span class="sd">    PARAMETER: 2.29 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R2290 / (a*R2250+b*R2350) )</span>
<span class="sd">    RATIONALE: Mg,Fe-OH minerals (at 2.3); also CO2 ice</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2250</span><span class="p">,</span> <span class="mi">2290</span><span class="p">,</span> <span class="mi">2350</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2250</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2290</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="d2300"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.d2300">[docs]</a><span class="k">def</span> <span class="nf">d2300</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: D2300</span>
<span class="sd">    PARAMETER: 2.3 micron drop</span>
<span class="sd">    FORMULATION: 1 - ( (CR2290+CR2320+CR2330) /\</span>
<span class="sd">      (CR2140+CR2170+CR2210) ) (CR values are observed R values\</span>
<span class="sd">      divided by values fit along the slope as determined between 1.8\</span>
<span class="sd">      and 2.53 microns - essentially continuum corrected))</span>
<span class="sd">    RATIONALE: hydrated minerals; particularly clays</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1815</span><span class="p">,</span> <span class="mi">2120</span><span class="p">,</span> <span class="mi">2170</span><span class="p">,</span> <span class="mi">2210</span><span class="p">,</span> <span class="mi">2290</span><span class="p">,</span> <span class="mi">2320</span><span class="p">,</span> <span class="mi">2330</span><span class="p">,</span> <span class="mi">2530</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1815</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2170</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2210</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2290</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2320</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2330</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                      <span class="mi">2530</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="c1"># return generic_func(data, wv, func = cf.d2300_func, **kwargs)</span>
    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">d2300_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2355"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2355">[docs]</a><span class="k">def</span> <span class="nf">bd2355</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2355</span>
<span class="sd">    PARAMETER: 2.35 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R2355 / (a * R2300+b * R2450) )</span>
<span class="sd">    RATIONALE: Chlorite Prehnite Pumpellyite</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2300</span><span class="p">,</span> <span class="mi">2355</span><span class="p">,</span> <span class="mi">2450</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2300</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2355</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="mi">2450</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span><span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="sindex"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.sindex">[docs]</a><span class="k">def</span> <span class="nf">sindex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: SINDEX</span>
<span class="sd">    PARAMETER: Convexity at 2.29 microns  due to absorptions at\</span>
<span class="sd">      1.9/2.1 microns and 2.4 microns</span>
<span class="sd">    FORMULATION: 1 - (R2100 + R2400) / (2 * R2290) CR\</span>
<span class="sd">      values are observed R values divided by values fit along the\</span>
<span class="sd">      slope as determined between 1.8 - 2.53 microns (essentially\</span>
<span class="sd">      continuum corrected))</span>
<span class="sd">    RATIONALE: hydrated minerals; particularly sulfates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2100</span><span class="p">,</span> <span class="mi">2400</span><span class="p">,</span> <span class="mi">2290</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">sindex_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="sindex2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.sindex2">[docs]</a><span class="k">def</span> <span class="nf">sindex2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: SINDEX2</span>
<span class="sd">    PARAMETER: Inverse lever rule to detect convexity at 2.29 μm due to 2.1 μm\</span>
<span class="sd">        and 2.4 μm absorptions</span>
<span class="sd">    FORMULATION (with kernels): 1 - (a * R2120 + b * R2400) / R2290</span>
<span class="sd">    RATIONALE: Hydrated sulfates (mono and polyhydrated sulfates) will be\</span>
<span class="sd">        strongly &gt; 0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2290</span><span class="p">,</span> <span class="mi">2400</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2120</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2290</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2400</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">sh_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="icer2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.icer2">[docs]</a><span class="k">def</span> <span class="nf">icer2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: ICER2</span>
<span class="sd">    PARAMETER: gauge 2.7 micron band</span>
<span class="sd">    FORMULATION: R2530 / R2600</span>
<span class="sd">    RATIONALE: CO2 ice will be &gt;&gt;1, H2O ice and soil will be about 1</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2530</span><span class="p">,</span> <span class="mi">2600</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_inverse_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bdcarb"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bdcarb">[docs]</a><span class="k">def</span> <span class="nf">bdcarb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BDCARB</span>
<span class="sd">    PARAMETER: overtone band depth</span>
<span class="sd">    FORMULATION: 1 - ( sqrt [ ( R2330 / (a*R2230+b*R2390) ) *\</span>
<span class="sd">      ( R2530/(c*R2390+d*R2600) ) ] )</span>
<span class="sd">    RATIONALE: carbonate overtones</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2230</span><span class="p">,</span> <span class="mi">2330</span><span class="p">,</span> <span class="mi">2390</span><span class="p">]</span>
    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2390</span><span class="p">,</span> <span class="mi">2530</span><span class="p">,</span> <span class="mi">2600</span><span class="p">]</span>

    <span class="n">bd_1</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd_2</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">bd_1</span> <span class="o">*</span> <span class="n">bd_2</span><span class="p">))</span></div>

<div class="viewcode-block" id="min2295_2480"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.min2295_2480">[docs]</a><span class="k">def</span> <span class="nf">min2295_2480</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: MIN2295_2480</span>
<span class="sd">    PARAMETER: Mg Carbonate overtone band depth and metal-OH band</span>
<span class="sd">    FORMULATION (with kernels): minimum( 1 -  (R2295 / (a * R2165 + b * R2364)),\</span>
<span class="sd">        1 - (R2480 / (a * R2364 + b * R2570)))</span>
<span class="sd">    RATIONALE: Mg carbonates; both overtones must be present</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2165</span><span class="p">,</span> <span class="mi">2295</span><span class="p">,</span> <span class="mi">2364</span><span class="p">]</span>
    <span class="n">kernel_set1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2165</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2295</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2364</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2364</span><span class="p">,</span> <span class="mi">2480</span><span class="p">,</span> <span class="mi">2570</span><span class="p">]</span>
    <span class="n">kernel_set2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2364</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2480</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2570</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">bd2295_val</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd2480_val</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bd2295_val</span><span class="p">,</span> <span class="n">bd2480_val</span><span class="p">)</span></div>

<div class="viewcode-block" id="min2345_2537"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.min2345_2537">[docs]</a><span class="k">def</span> <span class="nf">min2345_2537</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: MIN2345_2537</span>
<span class="sd">    PARAMETER: Ca/Fe Carbonate overtone band depth and metal-OH band</span>
<span class="sd">    FORMULATION (with kernels): minimum( 1 -  (R2345 / (a * R2250 + b * R2430)),\</span>
<span class="sd">        1 - (R2537 / (a * R2430 + b * R2602)))</span>
<span class="sd">    RATIONALE: Ca/Fe carbonates; both overtones must be present</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv_set1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2250</span><span class="p">,</span> <span class="mi">2345</span><span class="p">,</span> <span class="mi">2430</span><span class="p">]</span>
    <span class="n">kernel_set1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2250</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2345</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2430</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">wv_set2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2430</span><span class="p">,</span> <span class="mi">2537</span><span class="p">,</span> <span class="mi">2602</span><span class="p">]</span>
    <span class="n">kernel_set2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2430</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2537</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2602</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="n">bd2345_val</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set1</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">bd2537_val</span> <span class="o">=</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv_set2</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernel_set2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">bd2345_val</span><span class="p">,</span> <span class="n">bd2537_val</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2500h"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2500h">[docs]</a><span class="k">def</span> <span class="nf">bd2500h</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2500h</span>
<span class="sd">    PARAMETER: Mg Carbonate overtone band depth</span>
<span class="sd">    FORMULATION: 1 - ((R2500 + R2510) /  (R2540 + R2380))</span>
<span class="sd">    FORMULATION (with kernels): 1 - (R2480 / ((a * R2364) + (b * R2570)))</span>
<span class="sd">    RATIONALE: Mg carbonates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2380</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2510</span><span class="p">,</span> <span class="mi">2540</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2364</span><span class="p">,</span> <span class="mi">2480</span><span class="p">,</span> <span class="mi">2570</span><span class="p">]</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2364</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2480</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2570</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd2500h_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd3000"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd3000">[docs]</a><span class="k">def</span> <span class="nf">bd3000</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD3000</span>
<span class="sd">    PARAMETER: 3 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R3000 / (R2530*(R2530/R2210)) )</span>
<span class="sd">    RATIONALE: H2O, chemically bound or adsorbed</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2210</span><span class="p">,</span> <span class="mi">2530</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2210</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2530</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3000</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd3000_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd3100"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd3100">[docs]</a><span class="k">def</span> <span class="nf">bd3100</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD3100</span>
<span class="sd">    PARAMETER: 3.1 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R3120 / (a*R3000+b*R3250) )</span>
<span class="sd">    RATIONALE: H2O ice</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">3120</span><span class="p">,</span> <span class="mi">3250</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd3200"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd3200">[docs]</a><span class="k">def</span> <span class="nf">bd3200</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD3200</span>
<span class="sd">    PARAMETER: 3.2 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( R3320 / (a*R3250+b*R3390) )</span>
<span class="sd">    RATIONALE: CO2 ice</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3250</span><span class="p">,</span> <span class="mi">3320</span><span class="p">,</span> <span class="mi">3390</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd3400"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd3400">[docs]</a><span class="k">def</span> <span class="nf">bd3400</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_kernels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD3400</span>
<span class="sd">    PARAMETER: 3.4 micron band depth</span>
<span class="sd">    FORMULATION: 1 - ( (a*R3390+b*R3500) / (c*R3250+d*R3630) )</span>
<span class="sd">    RATIONALE: carbonates; organics</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3250</span><span class="p">,</span> <span class="mi">3390</span><span class="p">,</span> <span class="mi">3500</span><span class="p">,</span> <span class="mi">3630</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">use_kernels</span><span class="p">:</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3250</span><span class="p">,</span> <span class="mi">3320</span><span class="p">,</span> <span class="mi">3390</span><span class="p">]</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3250</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3420</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3630</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd3400_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="cindex"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.cindex">[docs]</a><span class="k">def</span> <span class="nf">cindex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: CINDEX</span>
<span class="sd">    PARAMETER: gauge 3.9 micron band</span>
<span class="sd">    FORMULATION: ( R3750 + (R3750-R3630) / (3750-3630) *\</span>
<span class="sd">      (3920-3750) ) / R3950 - 1</span>
<span class="sd">    RATIONALE: carbonates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    Algorithm differs from published - coded as per CAT</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3630</span><span class="p">,</span> <span class="mi">3750</span><span class="p">,</span> <span class="mi">3950</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">cindex_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="cindex2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.cindex2">[docs]</a><span class="k">def</span> <span class="nf">cindex2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: CINDEX</span>
<span class="sd">    PARAMETER: Inverse lever rule to detect convexity at 3.6 μm due to 3.4 μm and 3.9 μm\</span>
<span class="sd">        absorptions</span>
<span class="sd">    FORMULATION (with kernels): 1 - ((a * R3450 +  b * R3875) / 3610)</span>
<span class="sd">    RATIONALE: carbonates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>

<span class="sd">    Algorithm differs from published - coded as per CAT</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3450</span><span class="p">,</span> <span class="mi">3875</span><span class="p">,</span> <span class="mi">3610</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3450</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3875</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3610</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">sh_func</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r440"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r440">[docs]</a><span class="k">def</span> <span class="nf">r440</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R440</span>
<span class="sd">    Parameter: 0.44 micron reflectance</span>
<span class="sd">    FORMULATION (with kernels): R440</span>
<span class="sd">    Rationale: Clouds/Hazes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">440</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">440</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r530"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r530">[docs]</a><span class="k">def</span> <span class="nf">r530</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R530</span>
<span class="sd">    Parameter: 0.53 micron reflectance</span>
<span class="sd">    FORMULATION (with kernels): R530</span>
<span class="sd">    Rationale: TRU browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">530</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">530</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r600"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r600">[docs]</a><span class="k">def</span> <span class="nf">r600</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R600</span>
<span class="sd">    Parameter: 0.60 micron reflectance</span>
<span class="sd">    FORMULATION (with kernels): R600</span>
<span class="sd">    Rationale: TRU browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">600</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">600</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="irr1"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.irr1">[docs]</a><span class="k">def</span> <span class="nf">irr1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: IRR1</span>
<span class="sd">    Parameter: IR ratio 1</span>
<span class="sd">    FORMULATION (with kernels): R800 / R997</span>
<span class="sd">    Rationale: Aphelion ice clouds (&gt;1) versus seasonal or</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">997</span><span class="p">]</span>
    <span class="n">kernels</span>  <span class="o">=</span> <span class="p">{</span><span class="mi">800</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">997</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_inverse_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r1080"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r1080">[docs]</a><span class="k">def</span> <span class="nf">r1080</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R1080</span>
<span class="sd">    Parameter: 1.08 micron reflectance</span>
<span class="sd">    FORMULATION (with kernels): R1080</span>
<span class="sd">    Rationale: FAL browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1080</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1080</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r1506"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r1506">[docs]</a><span class="k">def</span> <span class="nf">r1506</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R1506</span>
<span class="sd">    Parameter: 1.51 micron reflectance</span>
<span class="sd">    FORMULATION (with kernels): R1506</span>
<span class="sd">    Rationale: TRU browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1506</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1506</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r2529"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r2529">[docs]</a><span class="k">def</span> <span class="nf">r2529</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R2529</span>
<span class="sd">    Parameter: 2.53 micron reflectance</span>
<span class="sd">    Formulation: R2529</span>
<span class="sd">    Rationale: TRU browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2529</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2529</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="bd2600"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.bd2600">[docs]</a><span class="k">def</span> <span class="nf">bd2600</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME: BD2600</span>
<span class="sd">    PARAMETER: 2.6 μm H 2 O band depth</span>
<span class="sd">    FORMULATION: 1 - (R2600 / (a * R2530 + b * R2630))</span>
<span class="sd">    RATIONALE: H 2 O vapor (accounts for spectral slope)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2530</span><span class="p">,</span> <span class="mi">2600</span><span class="p">,</span> <span class="mi">2630</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2530</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2600</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2630</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">bd_func2</span><span class="p">,</span> <span class="n">pass_wvs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="irr2"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.irr2">[docs]</a><span class="k">def</span> <span class="nf">irr2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: IRR2</span>
<span class="sd">    Parameter: IR ratio 2</span>
<span class="sd">    FORMULATION (with kernels): R2530 / R2210</span>
<span class="sd">    Rationale: Aphelion ice clouds versus seasonal or dust</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2210</span><span class="p">,</span> <span class="mi">2530</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2210</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2350</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="irr3"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.irr3">[docs]</a><span class="k">def</span> <span class="nf">irr3</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: IRR3</span>
<span class="sd">    Parameter: IR ratio 3</span>
<span class="sd">    FORMULATION (with kernels): R3500 / R3390</span>
<span class="sd">    Rationale: Aphelion ice clouds (higher values) versus seasonal or dust</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3390</span><span class="p">,</span> <span class="mi">3500</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3390</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3500</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">rockdust2_func</span><span class="p">,</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="r3920"><a class="viewcode-back" href="../../../../library/derived/crism/cat.html#libpyhat.derived.crism.crism_algs.r3920">[docs]</a><span class="k">def</span> <span class="nf">r3920</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name: R3920</span>
<span class="sd">    Parameter: 3.92 micron reflectance</span>
<span class="sd">    Formulation: R3920</span>
<span class="sd">    Rationale: IC2 browse product component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : ndarray</span>
<span class="sd">           (n,m,p) array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">     : ndarray</span>
<span class="sd">       the processed ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3920</span><span class="p">]</span>
    <span class="n">kernels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3920</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">generic_func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wv</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2018 - PyHAT Developers.
      </li>
      <li>
      Last updated on Oct 23, 2018.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>